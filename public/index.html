<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
	<title>ProjectHealth</title>
	
	<script src="socket.io/socket.io.js"></script>
	<link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="bootstrap-responsive.css">
  </head>
  <body>
  <div id="main" class="container">
  	  <h1 id="heading1">Health status</h1>

	  <div class="row">
		<div class="span12">
			<H2>HEALTH <span id="healthStatusIndicator"></span></H2>
			<button onclick="setHealthStatus('up');">Up & Running</button>
			<button onclick="setHealthStatus('down');">Down</button>
			<div id="healthInfo" class="infoline">...</div>
		</div>
	</div>

	  <div class="row">
		<div class="span12">
			<h2>BAMBOO <span id="bambooStatusIndicator"></span></h2>
			<button onclick="setBambooStatus('successful');">Ok</button>
			<button onclick="setBambooStatus('building');">Building</button>
			<button onclick="setBambooStatus('failed');">Failed</button>
			<div id="bambooInfo" class="infoline">...</div>
		</div>
	</div>

</div>
<hr>
<button onclick="updateNow();">Run now</button>
<button id="btnOverruleOfficeHours" onclick="overruleOfficeHours(true);">overrule OfficeHours</button>
<button id="btnResetOfficeHours" onclick="overruleOfficeHours(false);" style="display:NONE">reset to OfficeHours</button>
<button onclick="quitAll();">Quit process</button>
<button onclick="allDisco();">Dont press</button>
<button onclick="aBuzz();">Attention</button>
<button onclick="sayOutLoud('Please stand up!');">Standup</button>
<div id="generalInfo" class="infoline">...</div>
<br>
<input type="text" name="saytext" id="sayText" value="" size="50">&nbsp 
<button onclick="sayOutLoud()">Say out loud</button> <br>

<input type="radio" name="voice" value="rms" checked="checked">Male &nbsp;
<input type="radio" name="voice" value="slt"> Female &nbsp;
<input type="radio" name="voice" value="awb"> Sean &nbsp;

<script type="text/javascript">
	var socket = io.connect();
	
	socket.on('lightBamboo', function (data) {
		document.getElementById("bambooStatusIndicator").className = data.value;
		document.getElementById("bambooInfo").innerHTML = data.info;
	});
	
	socket.on('lightHealth', function (data) {
		document.getElementById("healthStatusIndicator").className = data.value;
		document.getElementById("healthInfo").innerHTML = data.info;
	});
	
	socket.on('generalInfo', function (data) {
		document.getElementById("generalInfo").innerHTML = data;
	});
	
	socket.on('heading1', function (data) {
		document.getElementById("heading1").innerHTML = data;
	});
	
	function updateNow() {
		socket.emit('updateNow', {});
	}

	function setBambooStatus(statusBamboo) {
		socket.emit('evtBamboo', { value: statusBamboo, info: 'set manually in frontend', reason: 'Caused by <manual action>' });
	}

	function setHealthStatus(statusHealth) {
		socket.emit('evtHealth', { value: statusHealth, info: 'set manually in frontend' });
	}

	function sayOutLoud() {
		var textToSay = document.getElementById("sayText").value;
		var radios = document.getElementsByName("voice");
		var voice = "rms";

		var i = 0;
		while (i < radios.length) {
			if (radios[i].checked) {
				voice = radios[i].value;
			}
			i++;        
		}
		
		console.log('voice found', voice );

		socket.emit('sayText', { value: textToSay , voice: voice });
	}

	function quitAll() {
		socket.emit('quitAll', {});
	}

	function overruleOfficeHours(data) {
		if (data === true) {
			document.getElementById("btnOverruleOfficeHours").style.display="none";
			document.getElementById("btnResetOfficeHours").style.display="initial";
		} else {
			document.getElementById("btnOverruleOfficeHours").style.display="initial";
			document.getElementById("btnResetOfficeHours").style.display="none";
		}	
		 
		socket.emit('officeHours', { data: data });
	}

	function allDisco() {
		socket.emit('allDisco', {});
		document.getElementById("bambooStatusIndicator").className = 'disco';
		document.getElementById("healthStatusIndicator").className = 'disco';
	}

	function aBuzz() {
		socket.emit('aBuzz', {});
	}

	socket.on('allOff', function (data) {
		document.getElementById("bambooStatusIndicator").className = '';
		document.getElementById("healthStatusIndicator").className = '';
	});

</script>
</body>
</html>